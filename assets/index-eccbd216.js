import{v as e,r as l,k as a,l as t,ak as o,aq as i,y as d,B as n,C as r,D as m,E as s,M as u,ag as p,J as c,z as f,O as h,L as V,u as b}from"./vendor-60cd9ffe.js";import{M as y,E as v,f as w}from"./element-ca729cb6.js";import{g,p as _,d as x,u as U,_ as N}from"./index-30b3d731.js";const k=(e,l)=>_(`/settings/admins/${e}`,l),C={class:"settings-page"},T={class:"tab-content"},j={class:"membership-level"},E={class:"membership-level"},L={class:"membership-level"},q={class:"tab-content"},A={class:"toolbar"},O={class:"toolbar-left"},R={class:"toolbar-right"},$={class:"tab-content"},z=N(e({__name:"index",setup(e){var N;const z=U(),B=l("membership"),I=l((null==(N=z.user)?void 0:N.id)||""),P=a({basic:{name:"普通会员",price:0,benefits:"基础服务权益\n每月2张优惠券\n标准客服支持"},gold:{name:"黄金会员",price:29.9,benefits:"全部基础权益\n每月5张优惠券\n优先客服支持\n95折服务优惠"},diamond:{name:"钻石会员",price:99.9,benefits:"全部黄金权益\n每月10张优惠券\n专属客服经理\n9折服务优惠\n免费上门评估"}}),F=l(!1),S=l([]),W=l(!1),D=l(""),M=a({visible:!1,loading:!1,title:"",form:{username:"",realName:"",email:"",phone:"",role:"admin",password:"",status:"active"}}),J=a({systemName:"家乐家政管理系统",systemLogo:"",servicePhone:"400-123-4567",serviceEmail:"service@jiale.com",companyAddress:"北京市朝阳区xxx街道xxx号",defaultServiceRate:10,minWithdrawAmount:100,withdrawFeeRate:2,autoConfirmTime:24,newOrderNotification:!0,withdrawNotification:!0,errorNotification:!0,notificationEmail:"admin@jiale.com"}),K=l(!1),G=l([]),H=async()=>{F.value=!0;try{const e=await g("/settings/membership");e&&Object.assign(P,e)}catch(e){v.error("获取会员配置失败")}finally{F.value=!1}},Q=async()=>{F.value=!0;try{await(e=P,_("/settings/membership",e)),v.success("会员配置保存成功")}catch(l){v.error("保存失败")}finally{F.value=!1}var e},X=async()=>{W.value=!0;try{const l=await(e={keyword:D.value},g("/settings/admins",e));S.value=l}catch(l){v.error("获取管理员列表失败"),S.value=[{id:"1",username:"admin",realName:"系统管理员",email:"admin@jiale.com",phone:"13800138000",role:"super_admin",status:"active",lastLoginTime:"2024-01-20 09:30:00",createTime:"2023-01-01 10:00:00"},{id:"2",username:"operator1",realName:"张三",email:"zhangsan@jiale.com",phone:"13800138001",role:"operator",status:"active",lastLoginTime:"2024-01-19 14:20:00",createTime:"2023-06-15 11:00:00"}]}finally{W.value=!1}var e},Y=()=>{M.title="添加管理员",M.form={username:"",realName:"",email:"",phone:"",role:"admin",password:"",status:"active"},M.visible=!0},Z=async()=>{if(M.form.username&&M.form.realName&&M.form.email){M.loading=!0;try{if("添加管理员"===M.title){if(!M.form.password)return void v.warning("请输入密码");await(e=M.form,_("/settings/admins",e)),v.success("添加成功")}else await k(M.form.id||"",M.form),v.success("更新成功");M.visible=!1,X()}catch(l){v.error("操作失败")}finally{M.loading=!1}var e}else v.warning("请填写完整信息")},ee=async e=>{try{await w.confirm(`确定要重置 ${e.realName} 的密码吗？`,"重置密码",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const a=await(l=e.id,_(`/settings/admins/${l}/reset-password`));v.success(`密码已重置为: ${a.newPassword}`)}catch(a){"cancel"!==a&&v.error("重置失败")}var l},le=async e=>{try{await w.confirm(`确定要删除管理员 ${e.realName} 吗？此操作不可恢复。`,"删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await(l=e.id,x(`/settings/admins/${l}`)),v.success("删除成功"),X()}catch(a){"cancel"!==a&&v.error("删除失败")}var l},ae=async()=>{K.value=!0;try{const e=await g("/settings/system");e&&Object.assign(J,e)}catch(e){v.error("获取系统配置失败")}finally{K.value=!1}},te=async()=>{K.value=!0;try{await(e=J,_("/settings/system",e)),v.success("系统配置保存成功")}catch(l){v.error("保存失败")}finally{K.value=!1}var e},oe=e=>({super_admin:"超级管理员",admin:"管理员",operator:"运营"}[e]||e),ie=e=>{"membership"===e?H():"admins"===e?X():"system"===e&&ae()};return t(()=>{H()}),(e,l)=>{const a=o("el-input"),t=o("el-input-number"),w=o("el-form-item"),g=o("el-button"),_=o("el-form"),x=o("el-tab-pane"),U=o("el-table-column"),N=o("el-tag"),z=o("el-switch"),de=o("el-table"),ne=o("el-icon"),re=o("el-upload"),me=o("el-tabs"),se=o("el-card"),ue=o("el-option"),pe=o("el-select"),ce=o("el-radio"),fe=o("el-radio-group"),he=o("el-dialog"),Ve=i("loading");return d(),n("div",C,[r(se,null,{default:m(()=>[r(me,{modelValue:B.value,"onUpdate:modelValue":l[23]||(l[23]=e=>B.value=e),onTabChange:ie},{default:m(()=>[r(x,{label:"会员配置",name:"membership"},{default:m(()=>[s("div",T,[r(_,{model:P,"label-width":"120px",style:{"max-width":"600px"}},{default:m(()=>[l[38]||(l[38]=s("h3",null,"会员等级设置",-1)),r(w,{label:"普通会员"},{default:m(()=>[s("div",j,[r(a,{modelValue:P.basic.name,"onUpdate:modelValue":l[0]||(l[0]=e=>P.basic.name=e),placeholder:"等级名称",style:{width:"200px"}},null,8,["modelValue"]),r(t,{modelValue:P.basic.price,"onUpdate:modelValue":l[1]||(l[1]=e=>P.basic.price=e),min:0,precision:2,placeholder:"价格",style:{width:"150px","margin-left":"12px"}},null,8,["modelValue"]),l[33]||(l[33]=s("span",{style:{"margin-left":"8px",color:"#909399"}},"元/月",-1))]),r(a,{modelValue:P.basic.benefits,"onUpdate:modelValue":l[2]||(l[2]=e=>P.basic.benefits=e),type:"textarea",rows:3,placeholder:"会员权益描述",style:{"margin-top":"12px"}},null,8,["modelValue"])]),_:1}),r(w,{label:"黄金会员"},{default:m(()=>[s("div",E,[r(a,{modelValue:P.gold.name,"onUpdate:modelValue":l[3]||(l[3]=e=>P.gold.name=e),placeholder:"等级名称",style:{width:"200px"}},null,8,["modelValue"]),r(t,{modelValue:P.gold.price,"onUpdate:modelValue":l[4]||(l[4]=e=>P.gold.price=e),min:0,precision:2,placeholder:"价格",style:{width:"150px","margin-left":"12px"}},null,8,["modelValue"]),l[34]||(l[34]=s("span",{style:{"margin-left":"8px",color:"#909399"}},"元/月",-1))]),r(a,{modelValue:P.gold.benefits,"onUpdate:modelValue":l[5]||(l[5]=e=>P.gold.benefits=e),type:"textarea",rows:3,placeholder:"会员权益描述",style:{"margin-top":"12px"}},null,8,["modelValue"])]),_:1}),r(w,{label:"钻石会员"},{default:m(()=>[s("div",L,[r(a,{modelValue:P.diamond.name,"onUpdate:modelValue":l[6]||(l[6]=e=>P.diamond.name=e),placeholder:"等级名称",style:{width:"200px"}},null,8,["modelValue"]),r(t,{modelValue:P.diamond.price,"onUpdate:modelValue":l[7]||(l[7]=e=>P.diamond.price=e),min:0,precision:2,placeholder:"价格",style:{width:"150px","margin-left":"12px"}},null,8,["modelValue"]),l[35]||(l[35]=s("span",{style:{"margin-left":"8px",color:"#909399"}},"元/月",-1))]),r(a,{modelValue:P.diamond.benefits,"onUpdate:modelValue":l[8]||(l[8]=e=>P.diamond.benefits=e),type:"textarea",rows:3,placeholder:"会员权益描述",style:{"margin-top":"12px"}},null,8,["modelValue"])]),_:1}),r(w,null,{default:m(()=>[r(g,{type:"primary",loading:F.value,onClick:Q},{default:m(()=>[...l[36]||(l[36]=[u(" 保存配置 ",-1)])]),_:1},8,["loading"]),r(g,{onClick:H},{default:m(()=>[...l[37]||(l[37]=[u("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])])]),_:1}),r(x,{label:"管理员账号",name:"admins"},{default:m(()=>[s("div",q,[s("div",A,[s("div",O,[r(g,{type:"primary",onClick:Y},{default:m(()=>[...l[39]||(l[39]=[u("添加管理员",-1)])]),_:1}),r(g,{onClick:X,loading:W.value},{default:m(()=>[...l[40]||(l[40]=[u("刷新",-1)])]),_:1},8,["loading"])]),s("div",R,[r(a,{modelValue:D.value,"onUpdate:modelValue":l[9]||(l[9]=e=>D.value=e),placeholder:"搜索用户名",style:{width:"200px"},clearable:"",onClear:X,onKeyup:p(X,["enter"])},null,8,["modelValue"])])]),c((d(),f(de,{data:S.value,stripe:""},{default:m(()=>[r(U,{prop:"username",label:"用户名","min-width":"150"}),r(U,{prop:"realName",label:"真实姓名",width:"120"}),r(U,{prop:"email",label:"邮箱","min-width":"200"}),r(U,{prop:"adminId",label:"ID",width:"80"}),r(U,{prop:"role",label:"角色",width:"120",align:"center"},{default:m(({row:e})=>{return[r(N,{type:(l=e.role,{super_admin:"danger",admin:"warning",operator:"primary"}[l]||"info")},{default:m(()=>[u(h(oe(e.role)),1)]),_:2},1032,["type"])];var l}),_:1}),r(U,{prop:"status",label:"状态",width:"100",align:"center"},{default:m(({row:e})=>[r(z,{modelValue:e.status,"onUpdate:modelValue":l=>e.status=l,"active-value":"active","inactive-value":"disabled",onChange:l=>(async e=>{try{await k(e.id,{status:e.status}),v.success("状态更新成功")}catch(l){v.error("状态更新失败")}})(e)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),r(U,{prop:"lastLoginTime",label:"最后登录",width:"180"}),r(U,{prop:"createTime",label:"创建时间",width:"180"}),r(U,{label:"操作",width:"200",fixed:"right"},{default:m(({row:e})=>[r(g,{link:"",type:"primary",size:"small",onClick:l=>{return a=e,M.title="编辑管理员",M.form={username:a.username,realName:a.realName,email:a.email,phone:a.phone,role:a.role,password:"",status:a.status},void(M.visible=!0);var a}},{default:m(()=>[...l[41]||(l[41]=[u(" 编辑 ",-1)])]),_:1},8,["onClick"]),r(g,{link:"",type:"warning",size:"small",onClick:l=>ee(e)},{default:m(()=>[...l[42]||(l[42]=[u(" 重置密码 ",-1)])]),_:1},8,["onClick"]),e.adminId!==I.value?(d(),f(g,{key:0,link:"",type:"danger",size:"small",onClick:l=>le(e)},{default:m(()=>[...l[43]||(l[43]=[u(" 删除 ",-1)])]),_:1},8,["onClick"])):V("",!0)]),_:1})]),_:1},8,["data"])),[[Ve,W.value]])])]),_:1}),r(x,{label:"系统参数",name:"system"},{default:m(()=>[s("div",$,[r(_,{model:J,"label-width":"150px",style:{"max-width":"800px"}},{default:m(()=>[l[50]||(l[50]=s("h3",null,"基础设置",-1)),r(w,{label:"系统名称"},{default:m(()=>[r(a,{modelValue:J.systemName,"onUpdate:modelValue":l[10]||(l[10]=e=>J.systemName=e),placeholder:"请输入系统名称"},null,8,["modelValue"])]),_:1}),r(w,{label:"系统Logo"},{default:m(()=>[r(re,{"file-list":G.value,"onUpdate:fileList":l[11]||(l[11]=e=>G.value=e),"auto-upload":!1,"list-type":"picture-card",limit:1},{default:m(()=>[r(ne,null,{default:m(()=>[r(b(y))]),_:1})]),_:1},8,["file-list"])]),_:1}),r(w,{label:"客服电话"},{default:m(()=>[r(a,{modelValue:J.servicePhone,"onUpdate:modelValue":l[12]||(l[12]=e=>J.servicePhone=e),placeholder:"请输入客服电话"},null,8,["modelValue"])]),_:1}),r(w,{label:"客服邮箱"},{default:m(()=>[r(a,{modelValue:J.serviceEmail,"onUpdate:modelValue":l[13]||(l[13]=e=>J.serviceEmail=e),placeholder:"请输入客服邮箱"},null,8,["modelValue"])]),_:1}),r(w,{label:"公司地址"},{default:m(()=>[r(a,{modelValue:J.companyAddress,"onUpdate:modelValue":l[14]||(l[14]=e=>J.companyAddress=e),placeholder:"请输入公司地址"},null,8,["modelValue"])]),_:1}),l[51]||(l[51]=s("h3",{style:{"margin-top":"30px"}},"业务设置",-1)),r(w,{label:"默认服务费率"},{default:m(()=>[r(t,{modelValue:J.defaultServiceRate,"onUpdate:modelValue":l[15]||(l[15]=e=>J.defaultServiceRate=e),min:0,max:100,precision:2,style:{width:"200px"}},null,8,["modelValue"]),l[44]||(l[44]=s("span",{style:{"margin-left":"8px",color:"#909399"}},"%",-1))]),_:1}),r(w,{label:"最低提现金额"},{default:m(()=>[r(t,{modelValue:J.minWithdrawAmount,"onUpdate:modelValue":l[16]||(l[16]=e=>J.minWithdrawAmount=e),min:0,precision:2,style:{width:"200px"}},null,8,["modelValue"]),l[45]||(l[45]=s("span",{style:{"margin-left":"8px",color:"#909399"}},"元",-1))]),_:1}),r(w,{label:"提现手续费率"},{default:m(()=>[r(t,{modelValue:J.withdrawFeeRate,"onUpdate:modelValue":l[17]||(l[17]=e=>J.withdrawFeeRate=e),min:0,max:100,precision:2,style:{width:"200px"}},null,8,["modelValue"]),l[46]||(l[46]=s("span",{style:{"margin-left":"8px",color:"#909399"}},"%",-1))]),_:1}),r(w,{label:"订单自动确认时间"},{default:m(()=>[r(t,{modelValue:J.autoConfirmTime,"onUpdate:modelValue":l[18]||(l[18]=e=>J.autoConfirmTime=e),min:0,style:{width:"200px"}},null,8,["modelValue"]),l[47]||(l[47]=s("span",{style:{"margin-left":"8px",color:"#909399"}},"小时",-1))]),_:1}),l[52]||(l[52]=s("h3",{style:{"margin-top":"30px"}},"通知设置",-1)),r(w,{label:"新订单通知"},{default:m(()=>[r(z,{modelValue:J.newOrderNotification,"onUpdate:modelValue":l[19]||(l[19]=e=>J.newOrderNotification=e)},null,8,["modelValue"])]),_:1}),r(w,{label:"提现申请通知"},{default:m(()=>[r(z,{modelValue:J.withdrawNotification,"onUpdate:modelValue":l[20]||(l[20]=e=>J.withdrawNotification=e)},null,8,["modelValue"])]),_:1}),r(w,{label:"系统异常通知"},{default:m(()=>[r(z,{modelValue:J.errorNotification,"onUpdate:modelValue":l[21]||(l[21]=e=>J.errorNotification=e)},null,8,["modelValue"])]),_:1}),r(w,{label:"通知邮箱"},{default:m(()=>[r(a,{modelValue:J.notificationEmail,"onUpdate:modelValue":l[22]||(l[22]=e=>J.notificationEmail=e),placeholder:"接收通知的邮箱"},null,8,["modelValue"])]),_:1}),r(w,null,{default:m(()=>[r(g,{type:"primary",loading:K.value,onClick:te},{default:m(()=>[...l[48]||(l[48]=[u(" 保存配置 ",-1)])]),_:1},8,["loading"]),r(g,{onClick:ae},{default:m(()=>[...l[49]||(l[49]=[u("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])])]),_:1})]),_:1},8,["modelValue"])]),_:1}),r(he,{modelValue:M.visible,"onUpdate:modelValue":l[32]||(l[32]=e=>M.visible=e),title:M.title,width:"500px","close-on-click-modal":!1},{footer:m(()=>[r(g,{onClick:l[31]||(l[31]=e=>M.visible=!1)},{default:m(()=>[...l[55]||(l[55]=[u("取消",-1)])]),_:1}),r(g,{type:"primary",loading:M.loading,onClick:Z},{default:m(()=>[...l[56]||(l[56]=[u(" 保存 ",-1)])]),_:1},8,["loading"])]),default:m(()=>[r(_,{model:M.form,"label-width":"100px"},{default:m(()=>[r(w,{label:"用户名",required:""},{default:m(()=>[r(a,{modelValue:M.form.username,"onUpdate:modelValue":l[24]||(l[24]=e=>M.form.username=e),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),r(w,{label:"真实姓名",required:""},{default:m(()=>[r(a,{modelValue:M.form.realName,"onUpdate:modelValue":l[25]||(l[25]=e=>M.form.realName=e),placeholder:"请输入真实姓名"},null,8,["modelValue"])]),_:1}),r(w,{label:"邮箱",required:""},{default:m(()=>[r(a,{modelValue:M.form.email,"onUpdate:modelValue":l[26]||(l[26]=e=>M.form.email=e),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1}),r(w,{label:"手机号"},{default:m(()=>[r(a,{modelValue:M.form.phone,"onUpdate:modelValue":l[27]||(l[27]=e=>M.form.phone=e),placeholder:"请输入手机号"},null,8,["modelValue"])]),_:1}),r(w,{label:"角色",required:""},{default:m(()=>[r(pe,{modelValue:M.form.role,"onUpdate:modelValue":l[28]||(l[28]=e=>M.form.role=e),placeholder:"选择角色",style:{width:"100%"}},{default:m(()=>[r(ue,{label:"超级管理员",value:"super_admin"}),r(ue,{label:"管理员",value:"admin"}),r(ue,{label:"运营",value:"operator"})]),_:1},8,["modelValue"])]),_:1}),"添加管理员"===M.title?(d(),f(w,{key:0,label:"密码",required:""},{default:m(()=>[r(a,{modelValue:M.form.password,"onUpdate:modelValue":l[29]||(l[29]=e=>M.form.password=e),type:"password",placeholder:"请输入密码","show-password":""},null,8,["modelValue"])]),_:1})):V("",!0),r(w,{label:"状态"},{default:m(()=>[r(fe,{modelValue:M.form.status,"onUpdate:modelValue":l[30]||(l[30]=e=>M.form.status=e)},{default:m(()=>[r(ce,{label:"active"},{default:m(()=>[...l[53]||(l[53]=[u("启用",-1)])]),_:1}),r(ce,{label:"disabled"},{default:m(()=>[...l[54]||(l[54]=[u("禁用",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),[["__scopeId","data-v-03950f3f"]]);export{z as default};
