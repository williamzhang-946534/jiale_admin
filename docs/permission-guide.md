# 权限管理系统使用指南

## 概述

本项目采用基于角色的访问控制（RBAC）模型，提供完整的权限管理功能。

## 权限体系结构

### 1. 权限格式
```
模块:操作
例如：user:view, order:assign, provider:audit
```

### 2. 权限模块
- **user**: 用户管理
- **order**: 订单管理  
- **provider**: 服务者管理
- **finance**: 财务管理
- **marketing**: 营销管理
- **system**: 系统管理

### 3. 操作类型
- **view**: 查看
- **create**: 创建
- **edit**: 编辑
- **delete**: 删除
- **audit**: 审核
- **ban**: 封禁
- **assign**: 指派
- **refund**: 退款
- **manage**: 管理
- **export**: 导出

## 预设角色

### 超级管理员 (super_admin)
- 权限：`*` (所有权限)
- 说明：拥有系统完全控制权

### 系统管理员 (admin)  
- 权限：用户管理、系统配置
- 说明：管理系统设置和用户账号

### 运营专员 (operator)
- 权限：用户查看、订单指派、服务者审核
- 说明：负责日常业务操作

### 财务专员 (finance)
- 权限：财务查看、提现审核、订单退款
- 说明：负责财务相关操作

### 营销专员 (marketer)
- 权限：营销活动管理、用户查看
- 说明：负责营销活动配置

### 只读用户 (viewer)
- 权限：仅查看权限
- 说明：只能查看数据，不能操作

## 权限控制方式

### 1. 路由级权限
控制页面访问权限，在路由meta中配置：
```typescript
{
  path: '/user/list',
  meta: { permissions: ['user:view'] }
}
```

### 2. 按钮级权限
使用 `v-permission` 指令控制按钮显示：
```vue
<el-button v-permission="['user:edit']">编辑</el-button>
```

### 3. 菜单级权限
根据用户权限动态生成菜单

## 高效管理策略

### 1. 权限分组管理
- 按功能模块分组权限
- 使用权限选择器批量配置
- 定期审查权限分配

### 2. 角色模板
- 使用预设角色模板快速创建
- 根据实际需求微调权限
- 保持角色数量合理（建议不超过10个）

### 3. 权限分析
- 定期运行权限分析报告
- 检查权限冲突和冗余
- 优化权限覆盖范围

### 4. 最佳实践

#### 权限设计原则
- **最小权限原则**: 只授予必要的权限
- **职责分离**: 不同角色承担不同职责
- **权限继承**: 高级角色包含低级角色权限

#### 角色命名规范
- 使用英文命名，如 `admin`, `operator`
- 名称要简洁明了
- 避免使用特殊字符

#### 权限审计
- 每月检查权限使用情况
- 及时回收多余权限
- 记录权限变更历史

## 常见问题

### Q: 如何创建新角色？
A: 在"角色管理"页面点击"新增角色"，使用权限选择器配置权限。

### Q: 如何批量导入角色？
A: 使用"导出配置"功能获取JSON格式，修改后导入（功能开发中）。

### Q: 权限冲突怎么办？
A: 查看权限分析报告，根据建议调整权限配置。

### Q: 如何测试权限？
A: 使用不同角色账号登录，验证权限控制是否生效。

## 开发指南

### 添加新权限
1. 在 `permissionConfig.ts` 中添加权限定义
2. 在路由配置中设置权限要求
3. 在组件中使用 `v-permission` 指令
4. 更新权限选择器组件

### 权限检查
```typescript
import { useAuthStore } from '@/store/auth'

const authStore = useAuthStore()
const canEdit = authStore.hasPermission('user:edit')
```

### 动态权限
```typescript
// 运行时检查权限
if (authStore.hasPermission(['order:assign', 'order:refund'])) {
  // 显示相关功能
}
```

## 安全建议

1. **定期审查**: 每季度审查权限配置
2. **权限最小化**: 避免授予过多权限
3. **操作日志**: 记录所有权限相关操作
4. **密码策略**: 强制使用强密码
5. **会话管理**: 设置合理的会话超时时间

## 更新日志

- **v1.0**: 基础权限管理功能
- **v1.1**: 添加权限分析工具
- **v1.2**: 增强权限选择器
- **v1.3**: 添加权限冲突检测

---

如有问题，请联系系统管理员。
